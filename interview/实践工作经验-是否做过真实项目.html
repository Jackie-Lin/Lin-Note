<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. H5 页面如何进行 首屏 优化？ | Hello Lin-Note</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="艮山的个人博客">
    
    <link rel="preload" href="/Lin-Note/assets/css/0.styles.a6cfce22.css" as="style"><link rel="preload" href="/Lin-Note/assets/js/app.8dfca736.js" as="script"><link rel="preload" href="/Lin-Note/assets/js/2.d548555d.js" as="script"><link rel="preload" href="/Lin-Note/assets/js/6.adae08c8.js" as="script"><link rel="prefetch" href="/Lin-Note/assets/js/10.ede08b31.js"><link rel="prefetch" href="/Lin-Note/assets/js/11.0dd35d6c.js"><link rel="prefetch" href="/Lin-Note/assets/js/12.71a941ed.js"><link rel="prefetch" href="/Lin-Note/assets/js/13.dc05e616.js"><link rel="prefetch" href="/Lin-Note/assets/js/14.773a114e.js"><link rel="prefetch" href="/Lin-Note/assets/js/15.a88cba0b.js"><link rel="prefetch" href="/Lin-Note/assets/js/16.d64daea0.js"><link rel="prefetch" href="/Lin-Note/assets/js/17.5da71dc0.js"><link rel="prefetch" href="/Lin-Note/assets/js/18.be765f16.js"><link rel="prefetch" href="/Lin-Note/assets/js/19.a5e0bfad.js"><link rel="prefetch" href="/Lin-Note/assets/js/20.75b374c9.js"><link rel="prefetch" href="/Lin-Note/assets/js/21.530371df.js"><link rel="prefetch" href="/Lin-Note/assets/js/22.5d5ff72d.js"><link rel="prefetch" href="/Lin-Note/assets/js/23.f0bdf90a.js"><link rel="prefetch" href="/Lin-Note/assets/js/24.8a8b7758.js"><link rel="prefetch" href="/Lin-Note/assets/js/25.f188b410.js"><link rel="prefetch" href="/Lin-Note/assets/js/26.2c604292.js"><link rel="prefetch" href="/Lin-Note/assets/js/27.770e87ef.js"><link rel="prefetch" href="/Lin-Note/assets/js/28.5e3ae0cc.js"><link rel="prefetch" href="/Lin-Note/assets/js/29.bb4f2492.js"><link rel="prefetch" href="/Lin-Note/assets/js/3.e2a8e340.js"><link rel="prefetch" href="/Lin-Note/assets/js/4.fdcb6bd8.js"><link rel="prefetch" href="/Lin-Note/assets/js/5.9d28a3bd.js"><link rel="prefetch" href="/Lin-Note/assets/js/7.42fc7cf9.js"><link rel="prefetch" href="/Lin-Note/assets/js/8.0674fcec.js"><link rel="prefetch" href="/Lin-Note/assets/js/9.88f0cce9.js">
    <link rel="stylesheet" href="/Lin-Note/assets/css/0.styles.a6cfce22.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Lin-Note/" class="home-link router-link-active"><!----> <span class="site-name">Hello Lin-Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Lin-Note/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/Lin-Note/bigFront/" class="nav-link">
  大前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发工具" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/vscode 插件篇.html" class="nav-link">
  vscode 插件篇
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/vscode 常用快捷键.html" class="nav-link">
  vscode 常用快捷键
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/typroa使用心得.html" class="nav-link">
  Typora
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/git 版本管理相关知识点.html" class="nav-link">
  Git
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习笔记" class="mobile-dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Lin-Note/note/TypeScript 笔记.html" class="nav-link">
  入门
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/note/CentOS 7 真机安装实测.html" class="nav-link">
  CentOS 7
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/note/跨域处理.html" class="nav-link">
  跨域
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/note/垃圾的小米路由器 bug.html" class="nav-link">
  小米路由器
</a></li></ul></div></div><div class="nav-item"><a href="/Lin-Note/inspiration/" class="nav-link">
  开发心得
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端面试" class="dropdown-title"><span class="title">前端面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端面试" class="mobile-dropdown-title"><span class="title">前端面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          分类面试题
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Lin-Note/interview/基础 面试题.html" class="nav-link">
  基础面
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/软技能-沟通、总结和学习能力.html" class="nav-link">
  软技能
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html" class="nav-link">
  实践经验
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/项目设计-能否成为项目负责人.html" class="nav-link">
  项目设计
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/知识广度-从前端到全栈.html" class="nav-link">
  知识广度
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/知识深度-原理和源码.html" class="nav-link">
  知识深度
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/编写高质量代码-正确、完整、清晰、鲁棒.html" class="nav-link">
  编写代码
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/分析和解决问题的思路-可以独立解决问题.html" class="nav-link">
  分析能力
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/Jackie-Lin/Lin-UI/tree/master" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.npmjs.com/package/lin-ui2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Npm
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Lin-Note/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/Lin-Note/bigFront/" class="nav-link">
  大前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发工具" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/vscode 插件篇.html" class="nav-link">
  vscode 插件篇
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/vscode 常用快捷键.html" class="nav-link">
  vscode 常用快捷键
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/typroa使用心得.html" class="nav-link">
  Typora
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/developmentTool/git 版本管理相关知识点.html" class="nav-link">
  Git
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习笔记" class="mobile-dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Lin-Note/note/TypeScript 笔记.html" class="nav-link">
  入门
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/note/CentOS 7 真机安装实测.html" class="nav-link">
  CentOS 7
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/note/跨域处理.html" class="nav-link">
  跨域
</a></li><li class="dropdown-item"><!----> <a href="/Lin-Note/note/垃圾的小米路由器 bug.html" class="nav-link">
  小米路由器
</a></li></ul></div></div><div class="nav-item"><a href="/Lin-Note/inspiration/" class="nav-link">
  开发心得
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端面试" class="dropdown-title"><span class="title">前端面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端面试" class="mobile-dropdown-title"><span class="title">前端面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          分类面试题
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Lin-Note/interview/基础 面试题.html" class="nav-link">
  基础面
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/软技能-沟通、总结和学习能力.html" class="nav-link">
  软技能
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html" class="nav-link">
  实践经验
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/项目设计-能否成为项目负责人.html" class="nav-link">
  项目设计
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/知识广度-从前端到全栈.html" class="nav-link">
  知识广度
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/知识深度-原理和源码.html" class="nav-link">
  知识深度
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/编写高质量代码-正确、完整、清晰、鲁棒.html" class="nav-link">
  编写代码
</a></li><li class="dropdown-subitem"><a href="/Lin-Note/interview/分析和解决问题的思路-可以独立解决问题.html" class="nav-link">
  分析能力
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/Jackie-Lin/Lin-UI/tree/master" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.npmjs.com/package/lin-ui2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Npm
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>分类面试题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Lin-Note/interview/基础 面试题.html" class="sidebar-link">基础 面试题</a></li><li><a href="/Lin-Note/interview/软技能-沟通、总结和学习能力.html" class="sidebar-link">软技能</a></li><li><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html" class="active sidebar-link">实践经验</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_1-h5-页面如何进行-首屏-优化" class="sidebar-link">1. H5 页面如何进行 首屏 优化？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_2-后端一次性返回-10w-条数据-你该如何渲染" class="sidebar-link">2. 后端一次性返回 10w 条数据，你该如何渲染？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_3-前端常用的设计模式有哪些-并说明使用场景" class="sidebar-link">3. 前端常用的设计模式有哪些？并说明使用场景？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_4-观察者模式和发布订阅模式的区别" class="sidebar-link">4. 观察者模式和发布订阅模式的区别？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_5-你在实际工作中-做过哪些-vue-优化" class="sidebar-link">5. 你在实际工作中，做过哪些 Vue 优化？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_6-你使用-vue-遇到过哪些坑" class="sidebar-link">6. 你使用 Vue 遇到过哪些坑？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_7-如何统一监听-vue-组件-报错" class="sidebar-link">7. 如何统一监听 Vue 组件 报错？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_8-如何一个-h5-很慢-你该如何排查性能问题" class="sidebar-link">8. 如何一个 H5 很慢，你该如何排查性能问题？</a></li><li class="sidebar-sub-header"><a href="/Lin-Note/interview/实践工作经验-是否做过真实项目.html#_9-你工作经历中-遇到过哪些项目难点-如何解决的" class="sidebar-link">9. 你工作经历中，遇到过哪些项目难点，如何解决的？</a></li></ul></li><li><a href="/Lin-Note/interview/项目设计-能否成为项目负责人.html" class="sidebar-link">项目设计</a></li><li><a href="/Lin-Note/interview/知识广度-从前端到全栈.html" class="sidebar-link">知识广度</a></li><li><a href="/Lin-Note/interview/知识深度-原理和源码.html" class="sidebar-link">知识深度</a></li><li><a href="/Lin-Note/interview/编写高质量代码-正确、完整、清晰、鲁棒.html" class="sidebar-link">编写代码</a></li><li><a href="/Lin-Note/interview/分析和解决问题的思路-可以独立解决问题.html" class="sidebar-link">分析能力</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-h5-页面如何进行-首屏-优化"><a href="#_1-h5-页面如何进行-首屏-优化" class="header-anchor">#</a> 1. H5 页面如何进行 首屏 优化？</h2> <p>路由懒加载</p> <ul><li>使用于 SPA (不适用 MPA)</li> <li>路由拆分，优先保证首页加载</li></ul> <p>服务端渲染 SSR (成本高)</p> <ul><li>传统的前后端分离 (SPA) 渲染页面的过程复杂</li> <li>SSR 渲染页面过程简单，所有性能好</li> <li>如果是纯 H5 页面，SSR 是性能优化的终极方案</li></ul> <blockquote><p>前后端分离：客户端，获取 html 再获取 data，最终再渲染到页面上</p> <p>SSR：服务端直接将渲染好的 HTML 发到客户端</p></blockquote> <p>SSR 是一门 ”古老“ 的技术</p> <ul><li>刚刚兴起 Web 1.0 时，就是 SSR 技术：PHP ASP JSP 等</li> <li>Nuxt.js (Vue)</li> <li>Next.js (React)</li></ul> <p>APP 预取</p> <ul><li>如果 H5 在 APP WebView 中展示，可使用 APP 预取</li> <li>用户访问列表页时，APP 预加载文章首屏内容</li> <li>用户进入 H5 页，直接从 APP 中获取内容，瞬间展示首屏</li></ul> <p>分页</p> <ul><li>针对列表页</li> <li>默认只展示第一页内容</li> <li>上划加载更多</li></ul> <p>图片懒加载 lazyLoad</p> <ul><li>针对详情页</li> <li>默认只展示文本内容，然后触发图片懒加载</li> <li>注意：提前设置图片尺寸，尽量只重绘不重排</li></ul> <p>Hybrid</p> <ul><li>提前将 HTML JS CSS 下载到 APP 内部</li> <li>在 APP webview 中使用 file:// 协议加载页面文件</li> <li>再用 Ajax 获取内容并展示 (也结合 APP 预取)</li></ul> <blockquote><p>file:// 协议: 用于打开本地文件的协议</p> <p>移动端 H5 要结合 App 能力去优化</p> <p>严格来说，hybrid 不是 H5，但这里回答出来没问题</p></blockquote> <p>总结：</p> <ul><li>路由懒加载</li> <li>服务端渲染 SSR</li> <li>App 预取</li> <li>分页</li> <li>图片懒加载</li> <li>Hybrid</li></ul> <blockquote><p>扩展</p> <ul><li>性能优化要配合分析、统计、评分等，做了事情要有结果</li> <li>性能优化也要配合体验，如骨架屏，loading 动画等</li> <li>不同的形式，有不同的优化方式，要积极和面试官沟通</li></ul></blockquote> <h2 id="_2-后端一次性返回-10w-条数据-你该如何渲染"><a href="#_2-后端一次性返回-10w-条数据-你该如何渲染" class="header-anchor">#</a> 2. 后端一次性返回 10w 条数据，你该如何渲染？</h2> <p>设计不合理</p> <ul><li>后端返回 10w 条数据，本身技术方案设计就不合理</li> <li>主动和面试官沟通此事 (这也许是面试官所期待的)</li> <li>如果面试官非要这么做，那再继续寻找解决方案</li></ul> <p>浏览器能否处理 10w 条数据</p> <ul><li>JS 没问题</li> <li>渲染到 DOM 会非常卡顿</li></ul> <p>自定义中间层</p> <ul><li>自定义 nodejs 中间层，获取并拆分这 10w 条数据</li> <li>前端对接 nodejs 中间层，而不是服务端</li> <li>成本比较高</li></ul> <p>虚拟列表 (不好实现)</p> <ul><li>只渲染可视区域 DOM</li> <li>其他隐藏区域不显示，只用 <code>&lt;div&gt;</code> 撑起高度</li> <li>随着浏览器滚动，创建和销毁 DOM</li></ul> <p>虚拟列表 - 第三方 lib</p> <ul><li>虚拟列表实现起来非常复杂，可借用第三方 lib</li> <li>Vue-virtual-scroll-list</li> <li>React-virtualiszed</li></ul> <blockquote><p>重点</p> <ul><li>要主动沟通，表达观点 (也许正在考察你的沟通能力)</li> <li>后端的问题，首先要用后端的思维去解决 -- 中间层</li> <li>虚拟列表只是无奈的选择，实现复杂而效果不一定好 (低配手机)</li></ul></blockquote> <h2 id="_3-前端常用的设计模式有哪些-并说明使用场景"><a href="#_3-前端常用的设计模式有哪些-并说明使用场景" class="header-anchor">#</a> 3. 前端常用的设计模式有哪些？并说明使用场景？</h2> <p>设计原则</p> <ul><li>最重要的思想：开放封闭原则</li> <li>对扩展开放</li> <li>对修改封闭</li></ul> <p>工厂模式</p> <ul><li>用一个工厂函数，来创建实例，隐藏 new</li> <li>如 jQuery 的 $ 函数</li> <li>如 React createElement 函数</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// 工厂模式示例</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">factory</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// if else</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><p>单例模式</p> <ul><li>全局唯一的实例 (无法生成第二个)</li> <li>如 Vuex Redux 的 store</li> <li>如全局唯一的 dialog modal</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// 单例模式实例</span>
<span class="token keyword">class</span> <span class="token class-name">SingleTon</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> instance<span class="token operator">:</span> SingleTon <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> SingleTon <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleTon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s <span class="token operator">=</span> SingleTon<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span><span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span><span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> SingleTon<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s <span class="token operator">===</span> s1<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><blockquote><p>单例模式 - 扩展</p> <ul><li>JS 是单线程的，创建单例很简单</li> <li>Java 是支持多线程的，创建单例要考虑锁死线程</li> <li>否则多个线程同时创建，单例就重复了 (多线程共享进程内存)</li></ul></blockquote> <p>代理模式</p> <ul><li>使用者不能直接访问对象，而是访问一个代理层</li> <li>在代理层可以监听 get set 做很多事情</li> <li>如 ES6 Proxy 实现 Vue3 响应式</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// 代理模式实例</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">getting </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>propKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setting </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>propKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>观察者模式实例</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// 一个主题，一个观察者，主题变化之后触发观察者执行</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>发布订阅 - 自定义事件</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// 绑定</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 事件1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 事件2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 触发执行</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>温故知新: 绑定的事件要记得解除，防内存泄漏</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 事件1 */</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 事件2 */</span>
<span class="token punctuation">}</span>

<span class="token comment">// mounted 时绑定</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">,</span> fn1<span class="token punctuation">)</span><span class="token punctuation">;</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">,</span> fn2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// beforeUnmount 时解绑</span>
event<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">,</span> fn1<span class="token punctuation">)</span><span class="token punctuation">;</span>
event<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">&quot;event-key&quot;</span><span class="token punctuation">,</span> fn2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></blockquote> <p>装饰器模式</p> <ul><li>原功能不变，增加一些新功能 (AOP 面向切面编程)</li> <li>ES 和 Typescript 的 Decorator 语法</li> <li>类装饰器，方法装饰器</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// 类的装饰</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">testable</span></span>
<span class="token keyword">class</span> <span class="token class-name">MyTestableClass</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">testable</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  target<span class="token punctuation">.</span>isTestable <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
MyTestableClass<span class="token punctuation">.</span>isTestable<span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// 方法的装饰</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  @<span class="token keyword">readonly</span>
  <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>nest.js 中比较完美的使用装饰器</p></blockquote> <p>总结</p> <ul><li>工厂模式</li> <li>单例模式</li> <li>代理模式</li> <li>观察者模式</li> <li>发布订阅模式</li> <li>装饰器模式</li></ul> <blockquote><p>注意</p> <ul><li>经典设计模式有 23 个，这是基于后端写的，前端不是都常用</li> <li>要结合应用场景</li></ul></blockquote> <h2 id="_4-观察者模式和发布订阅模式的区别"><a href="#_4-观察者模式和发布订阅模式的区别" class="header-anchor">#</a> 4. 观察者模式和发布订阅模式的区别？</h2> <p>观察者模式</p> <ul><li>Subject 和 Observer 直接绑定，没有中间媒介</li> <li>如 addEventlistener 绑定事件</li></ul> <p>发布订阅</p> <ul><li>Publisher 和 Observer 互不相似，需要中间媒介 Event channel</li> <li>如 EventBus 自定义事件</li></ul> <p>区别</p> <p><img src="/Lin-Note/assets/img/image-20230117175900455-1675344086973-28.f8b2c82f.png" alt="image-20230117175900455"></p> <h2 id="_5-你在实际工作中-做过哪些-vue-优化"><a href="#_5-你在实际工作中-做过哪些-vue-优化" class="header-anchor">#</a> 5. 你在实际工作中，做过哪些 Vue 优化？</h2> <p>v-if 和 v-show</p> <ul><li>v-if 彻底销毁组件</li> <li>v-show 使用 CSS 隐藏组件</li> <li>大部分情况下使用 v-if 更好，不要过度优化</li></ul> <p>v-for 使用 key</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- 而且，key 不要用 index --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(id, name) in list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>使用 computed 缓存</p> <div class="language-vue extra-class"><pre class="language-vue"><code>export default { data() { return { msgList: [ ... ] //消息列表 } }, computed: {
// 未读消息的数量 unreadCount() { return this.msgList.filter(m =&gt; m.read ===
false).length } } }
</code></pre></div><p>keep-alive 缓存组件</p> <ul><li>频繁切换的组件，如 tabs</li> <li>不要乱用，缓存太多会占用内存，且不好 debug</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>// 简单实例
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child1</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num === 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Child1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child2</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Child2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>异步组件</p> <ul><li>针对体积较大的组件，如编辑器、复杂表格、复杂表单等</li> <li>拆包，需要时异步加载，不需要时不加载</li> <li>减少主包的体积，首页会加载更快</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>// 模拟加载比较大子包 Vue3 的写法 // 总页面 Home.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsyncComponentDemo</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AsyncComponentDemo</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> AsyncComponentDemo <span class="token keyword">from</span> <span class="token string">&quot;@/components/AsyncComponentDemo/index&quot;</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>// 主 index.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Child</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineAsyncComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;AsyncComponent&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">Child</span><span class="token operator">:</span> <span class="token function">defuuneAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpacjChunkName: &quot;async-child&quot; */</span> <span class="token string">&quot;./Child.vue&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>// 子 Child.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>async component child<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Child&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>路由懒加载</p> <ul><li>项目比较大，拆分路由，保证首页先加载</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>// router/index.js - 路由表
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/about&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;About&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpacjChunkName: &quot;async-child&quot; */</span> <span class="token string">&quot;../views/About.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>服务端渲染 SSR</p> <ul><li>可使用 Nuxt.js</li> <li>按需优化，使用 SSR 的成本比较高</li></ul> <blockquote><p>总结</p> <ul><li>v-if 和 v-show</li> <li>v-for 使用 key</li> <li>computed 缓存数据</li> <li>keep-alive 缓存组件</li> <li>异步组件 路由懒加载</li> <li>SSR</li></ul></blockquote> <h2 id="_6-你使用-vue-遇到过哪些坑"><a href="#_6-你使用-vue-遇到过哪些坑" class="header-anchor">#</a> 6. 你使用 Vue 遇到过哪些坑？</h2> <p>内存泄漏</p> <ul><li>全局变量、全局事件、全局定时器</li> <li>自定义事件</li></ul> <p>Vue2 响应式的缺陷 (Vue3 不再有)</p> <ul><li>data 新增属性用 Vue.set</li> <li>data 删除属性用 Vue.delete</li> <li>无法直接修改数据 arr[index] = value</li></ul> <p>路由切换时 scroll 到顶部</p> <ul><li>SPA 的通病，不仅仅是 Vue</li> <li>如，列表页，滚动到第二屏，点击进入详情页</li> <li>再返回到列表页 (此时组件重新渲染) 就 scroll 到顶部</li></ul> <p>路由切换时 scroll 到顶部 - 解决方案</p> <ul><li>在列表页缓存数据和 scrollTop 值</li> <li>当再次返回列表页时，渲染组件，执行 scrollTo(xx)</li> <li>终极方案: MAP + APP WebView（MAP 就是 webView 上再加一个 webView）</li></ul> <blockquote><p>总结</p> <ul><li>日常要注意记录总结，遇到坑就记录下，下次面试时就能用到</li></ul></blockquote> <h2 id="_7-如何统一监听-vue-组件-报错"><a href="#_7-如何统一监听-vue-组件-报错" class="header-anchor">#</a> 7. 如何统一监听 Vue 组件 报错？</h2> <p>window.onerror (用于 JS 报错监听)</p> <ul><li>全局监听所有 JS 报错</li> <li>但它是 JS 级别的，识别不了 Vue 组件信息</li> <li>捕捉一些 Vue 监听不到的错误</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>// 代码演示 对 windiow error 的监听的两种方式
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第一种方式</span>
    <span class="token comment">// msg: 错误信息、source: 那个文件夹、line: 哪一行、column: 哪一列，error: 错误的对象</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> source<span class="token punctuation">,</span> line<span class="token punctuation">,</span> column<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;window.onerror----&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> source<span class="token punctuation">,</span> line<span class="token punctuation">,</span> column<span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 第二种方式</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;window error&quot;</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>errorCaptured 生命周期（Vue 的报错监听）</p> <ul><li>监听所有下级组件的错误</li> <li>返回 false 会阻止向上传播</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>// App.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">errorCaptured</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;errorCaptured---&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 返回false 就不会向上传播，window.onerror 就获取不到</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>errorHandler（Vue 的报错监听）</p> <ul><li>Vue 全局错误监听，所有组件错误都会汇总到这里</li> <li>会忽略掉，window.onerror</li> <li>但 errorCaptured 返回 false, 不会传播到这里</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 代码实例</span>
<span class="token comment">// main.js</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">errorHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;errorHandler----&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>扩展：</p> <ul><li>wiondow.onerror 能监听异步报错</li> <li>errorCaptured、errorHandler 只能监听非异步报错</li> <li>Promise 为处理的 catch 需要 onunhandledrejection</li></ul></blockquote> <blockquote><p>重点</p> <ul><li>实际工作中，三者要结合使用</li> <li>errorCaptured 监听一些重要、有风险组件的错误</li> <li>window.onerror 和 errorHandler 候补全局监听</li></ul></blockquote> <h2 id="_8-如何一个-h5-很慢-你该如何排查性能问题"><a href="#_8-如何一个-h5-很慢-你该如何排查性能问题" class="header-anchor">#</a> 8. 如何一个 H5 很慢，你该如何排查性能问题？</h2> <p>前端性能指标</p> <ul><li>First Paint (FP) 第一次渲染</li> <li>First Contentful Paint (FCP) 第一次有内容的渲染</li> <li>First Meaningful Paint (FMP) 第一次有意义的渲染 --- 以弃用，改用 LCP</li> <li>DomContentLoaded (DCL) 原生的一个浏览器事件 (页面 DOM 下载完成)</li> <li>Largest Contentfull Paint (LCP) 页面最大的内容已经下载完了</li> <li>Load (L) 整个页面及所有依赖资源如样式表和图片都已完成加载</li></ul> <p>工具</p> <ul><li>Chrome devTools</li> <li></li></ul> <p>Chrome devTools</p> <ul><li>Performance 可查看上述性能指标，并有网页快照</li> <li>NetWork 可以查看各个资源的加载时间</li></ul> <p>Performance</p> <p><img src="/Lin-Note/assets/img/image-20230117214536288-1675344092917-31.a6aafd58.png" alt="image-20230117214536288"></p> <p>NetWork</p> <p><img src="/Lin-Note/assets/img/image-20230117214626370-1675344096521-34.fb35e4dc.png" alt="image-20230117214626370"></p> <p>Lighthouse</p> <ul><li><p>非常流行的第三方性能评测工具</p></li> <li><p>支持移动端和 PC</p></li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>// <span class="token function">npm</span> 使用方法
<span class="token function">npm</span> i lighthouse -g
lighthouse https://www.imooc.com/ --view --preset<span class="token operator">=</span>desktop
</code></pre></div><p><img src="/Lin-Note/assets/img/image-20230117221335022-1675344099190-37.80459d7b.png" alt="image-20230117221335022"></p> <p><img src="/Lin-Note/assets/img/image-20230117221418640-1675344103033-40.5f870012.png" alt="image-20230117221418640"></p> <p>识别问题：哪里慢</p> <ul><li>加载慢？</li> <li>渲染慢？</li></ul> <p>加载慢示例</p> <p><img src="/Lin-Note/assets/img/image-20230117223235526-1675344106425-43.82e134df.png" alt="image-20230117223235526"></p> <p>如果是网页加载慢</p> <ul><li>优化服务端硬件配置，使用 CDN</li> <li>路由懒加载，大组件异步加载 --- 减少主包的体积</li> <li>优化 HTTP 缓存策略</li></ul> <p>如果是网页渲染慢</p> <ul><li>优化服务端接口 (如 Ajax 获取数据慢)</li> <li>继续分析，优化前端组件内部的逻辑 (参考 vue React 优化)</li> <li>服务端渲染 SSR</li></ul> <p>持续跟进</p> <ul><li>性能优化是一个循序渐进的过程，不像 bug 一次性解决</li> <li>持续跟进统计结果，再逐步分析性能瓶颈，持续优化</li> <li>可使用第三方统计服务，如阿里云 ARMS、百度统计</li></ul> <blockquote><p>总结</p> <ul><li>分析性能指标，找到慢的原因</li> <li>对症下药，解决问题</li> <li>持续跟进，持续优化</li> <li>使用 ”二分法“，可逐步找出问题根源</li> <li>要有 ”监控“、”持续跟进“ 的思维。解决了问题，还得保持住</li></ul></blockquote> <h2 id="_9-你工作经历中-遇到过哪些项目难点-如何解决的"><a href="#_9-你工作经历中-遇到过哪些项目难点-如何解决的" class="header-anchor">#</a> 9. 你工作经历中，遇到过哪些项目难点，如何解决的？</h2> <blockquote><p>种一棵树，关键在 10 年前 和 现在</p></blockquote> <p>遇到问题要注意积累</p> <ul><li>每个人都会遇到难题，总有几个问题让你抓耳挠腮</li> <li>日常要注意积累，解决了问题就自己写文章复盘一下</li></ul> <p>如果之前没有积累</p> <ul><li>回顾一下半年之内你遇到的一个难题 (肯定会有的)</li> <li>想一下当时的解决方案, 以及解决之后的效果</li> <li>写一篇文章记录一下 (必须写出来)</li></ul> <p>答案模板</p> <ul><li>描述问题：背景 + 现象 + 造成的影响</li> <li>问题如何被解决：分析 + 解决</li> <li>自己的成长：学到了什么 + 以后如何避免</li></ul> <p>示例</p> <ul><li>问题：编辑器只能回显 JSON 格式，而不支持老版本的 html 格式</li> <li>解决：使用 HTML 属性表示 JSON 的数据，即可解决这个问题</li> <li>成长：要考虑完整的输入输出 + 考虑旧版本用户 + 参考其他产品</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/16/2023, 3:45:31 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Lin-Note/interview/软技能-沟通、总结和学习能力.html" class="prev">
        软技能
      </a></span> <span class="next"><a href="/Lin-Note/interview/项目设计-能否成为项目负责人.html">
        项目设计
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Lin-Note/assets/js/app.8dfca736.js" defer></script><script src="/Lin-Note/assets/js/2.d548555d.js" defer></script><script src="/Lin-Note/assets/js/6.adae08c8.js" defer></script>
  </body>
</html>
